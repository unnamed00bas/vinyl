# Vinyl - Telegram Mini App

## Описание

Vinyl - это мини-приложение для Telegram, которое позволяет пользователям создавать уникальные виниловые пластинки с музыкой на основе текстового описания. Приложение использует AI для генерации музыки, изображений и создания красивых анимированных видео.

## Основные возможности

### Для пользователей:
- 🎵 Генерация музыки через Suno API (через KIE AI)
- 🎨 Автоматическая генерация обложки или загрузка собственного изображения
- 🎬 Создание видео с вращающейся виниловой пластинкой
- 💰 Первая генерация бесплатна, последующие за Telegram Stars
- 📱 Работает как Telegram Mini App, веб-сайт и мобильное приложение
- 🔗 Возможность поделиться результатом

### Для администраторов:
- 📊 Полная админ-панель с статистикой
- 👥 Управление пользователями
- 🎵 Просмотр всех генераций
- ⚙️ Настройки приложения
- 💰 Отслеживание доходов

## Технологический стек

### Frontend:
- **Next.js 14** - React фреймворк с App Router
- **TypeScript** - Типизация
- **Tailwind CSS** - Стилизация
- **Telegram Mini App SDK** - Интеграция с Telegram

### Backend:
- **Next.js API Routes** - API endpoints
- **Prisma** - ORM для работы с базой данных
- **SQLite** - База данных (локальная)
- **FFmpeg** - Генерация видео
- **Canvas** - Рендеринг графики

### Интеграции:
- **KIE AI** - Доступ к Suno API и LLM
- **Telegram Bot API** - Интеграция с Telegram
- **Telegram Stars** - Система платежей

## Архитектура

```
┌─────────────────┐
│  Telegram Mini   │
│      App         │
└────────┬─────────┘
         │
         ▼
┌─────────────────┐
│   Next.js App   │
│  (Frontend +    │
│   API Routes)   │
└────────┬────────┘
         │
    ┌────┴────┐
    │         │
    ▼         ▼
┌────────┐ ┌──────────┐
│  KIE   │ │ Telegram │
│   AI   │ │   Bot    │
└────────┘ └──────────┘
    │
    ▼
┌────────┐
│  Suno  │
│   API  │
└────────┘
```

## Процесс генерации

1. **Пользователь описывает музыку** → Промпт улучшается через LLM
2. **Генерация музыки** → Suno API создает аудио трек
3. **Генерация изображения** → AI создает обложку (или используется загруженное)
4. **Создание видео** → FFmpeg генерирует видео с вращающейся пластинкой
5. **Уведомление** → Пользователь получает готовое видео в Telegram

## Структура проекта

```
vinyl/
├── app/                      # Next.js приложение
│   ├── api/                 # API endpoints
│   │   ├── generate/        # Генерация пластинки
│   │   ├── generations/     # Список генераций
│   │   ├── admin/           # Админ API
│   │   ├── payment/         # Платежи
│   │   └── telegram/        # Telegram webhook
│   ├── admin/               # Админ-панель
│   └── page.tsx             # Главная страница
├── components/              # React компоненты
│   ├── admin/              # Компоненты админки
│   ├── GenerationForm.tsx  # Форма создания
│   ├── GenerationList.tsx  # Список генераций
│   └── ...
├── lib/                     # Утилиты
│   ├── kie-ai.ts           # Интеграция с KIE AI
│   ├── telegram.ts         # Telegram API
│   ├── video-generator.ts  # Генерация видео
│   └── prisma.ts           # Prisma client
├── prisma/                  # Схема базы данных
├── server/                  # Express сервер (опционально)
└── scripts/                 # Скрипты инициализации
```

## База данных

### Основные модели:
- **User** - Пользователи Telegram
- **Generation** - Генерации пластинок
- **Payment** - Платежи через Telegram Stars
- **Admin** - Администраторы
- **Settings** - Настройки приложения

## Безопасность

- JWT токены для админ-панели
- Валидация данных от Telegram
- Защита API endpoints
- Хеширование паролей (bcrypt)

## Развертывание

### Требования:
- Node.js 18+
- FFmpeg
- Telegram Bot Token
- KIE AI API Key

### Шаги:
1. Клонировать репозиторий
2. Установить зависимости: `npm install`
3. Настроить `.env` файл
4. Запустить миграции: `npm run db:migrate`
5. Инициализировать данные: `npm run setup`
6. Запустить приложение: `npm run dev`

Подробнее в [SETUP.md](./SETUP.md)

## Монетизация

- Первая генерация бесплатна для каждого пользователя
- Последующие генерации стоят 10 Telegram Stars
- Premium пользователи Telegram могут иметь дополнительные преимущества

## Будущие улучшения

- [ ] Поддержка разных стилей пластинок
- [ ] Настройка скорости вращения
- [ ] Экспорт в разные форматы
- [ ] Социальные функции (лайки, комментарии)
- [ ] Галерея популярных пластинок
- [ ] Интеграция с другими музыкальными сервисами

## Лицензия

MIT

## Поддержка

При возникновении проблем создайте issue в репозитории или обратитесь к документации:
- [SETUP.md](./SETUP.md) - Инструкция по установке
- [KIE_AI_INTEGRATION.md](./KIE_AI_INTEGRATION.md) - Интеграция с KIE AI
